---
import External from "@assets/icons/external.svg";
import Share from "@assets/icons/share.svg";
import Button from "@components/Button.astro";
import type { z } from "astro:content";
import type { BlogSchema } from "src/content.config";
import "../styles/blog.scss";
import Layout from "./Layout.astro";

type Props = {
  frontmatter: z.infer<typeof BlogSchema>;
};

const { frontmatter } = Astro.props;

const createdAt = new Date(frontmatter.createdAt);
---

<Layout title={frontmatter.title} description={frontmatter.summary}>
  <div id="summary-header">
    <div class="text">
      <h1>{frontmatter.title}</h1>

      <p>
        <time datetime={createdAt.toDateString()}>
          {
            createdAt.toLocaleString("en-US", {
              month: "long",
              day: "numeric",
              year: "numeric",
            })
          }
        </time>
        {
          frontmatter.brandName
            ? `â€¢ Client work paid for by ${frontmatter.brandName}`
            : ""
        }
      </p>

      <div class="buttons">
        {
          frontmatter.projectUrl ? (
            <Button href={frontmatter.projectUrl}>
              <External />
              View project
            </Button>
          ) : (
            ""
          )
        }

        <Button id="share-sheet" variant="secondary">
          <Share />
          Share article
        </Button>
      </div>
    </div>

    {
      frontmatter.bannerPath ? (
        <img
          src={frontmatter.bannerPath}
          alt={frontmatter.bannerAlt}
          style={`background-image: url(${frontmatter.bannerThumbnailPath});`}
        />
      ) : (
        ""
      )
    }
  </div>

  <main>
    <slot />
  </main>
</Layout>

<style lang="scss">
  #summary-header,
  main {
    padding: 1rem;
    margin: 1rem auto;
  }

  main {
    max-width: 75ch;
  }

  #summary-header {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 3rem;

    .text {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem;
      text-align: center;
      max-width: 75ch;
    }

    .buttons {
      display: flex;
      gap: 0.5rem;
    }

    img {
      border-radius: 1.25rem;
      border: 2px solid var(--color-850);
      width: 100%;
      max-width: calc(75ch + 100px);
    }
  }
</style>
